"use strict";var S=Object.create;var c=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,H=Object.prototype.hasOwnProperty;var T=(e,t)=>{for(var r in t)c(e,r,{get:t[r],enumerable:!0})},p=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of w(t))!H.call(e,o)&&o!==r&&c(e,o,{get:()=>t[o],enumerable:!(s=b(t,o))||s.enumerable});return e},n=(e,t,r)=>(p(e,t,"default"),r&&p(r,t,"default")),v=(e,t,r)=>(r=e!=null?S(I(e)):{},p(t||!e||!e.__esModule?c(r,"default",{value:e,enumerable:!0}):r,e)),N=e=>p(c({},"__esModule",{value:!0}),e);var i={};T(i,{clerkClient:()=>u,clerkPlugin:()=>F,getAuth:()=>L});module.exports=N(i);n(i,require("@clerk/backend"),module.exports);var g=v(require("fastify-plugin"));var m=["onRequest","preHandler"];var _=require("@clerk/backend/internal");var C=require("@clerk/backend");var y=require("@clerk/backend/internal"),h=require("@clerk/shared/apiUrlFromPublishableKey"),E=process.env.CLERK_API_VERSION||"v1",f=process.env.CLERK_SECRET_KEY||"",l=process.env.CLERK_PUBLISHABLE_KEY||"",d=process.env.CLERK_API_URL||(0,h.apiUrlFromPublishableKey)(l),R=process.env.CLERK_JWT_KEY||"",k={name:"@clerk/fastify",version:"2.2.20",environment:"production"},{Cookies:V,Headers:A}=y.constants;var u=(0,C.createClerkClient)({secretKey:f,apiUrl:d,apiVersion:E,jwtKey:R,userAgent:"@clerk/fastify@2.2.20",sdkMetadata:k});var K=e=>{let t=new Headers(Object.keys(e.headers).reduce((s,o)=>{let a=e.headers[o];return a&&(typeof a=="string"?s.set(o,a):s.set(o,a.join(","))),s},new Headers)),r=new URL(e.url||"",`${e.protocol}://clerk-dummy`);return new Request(r,{method:e.method,headers:t})};var O=e=>async(t,r)=>{let s=K(t),o=await u.authenticateRequest(s,{...e,secretKey:e.secretKey||f,publishableKey:e.publishableKey||l});if(o.headers.forEach((P,q)=>r.header(q,P)),o.headers.get(A.Location))return r.code(307).send();if(o.status===_.AuthStatus.Handshake)throw new Error("Clerk: handshake status without redirect");t.auth=o.toAuth()};var Y=(e,t,r)=>{e.decorateRequest("auth",null);let s=t.hookName||"preHandler";if(!m.includes(s))throw new Error(`Unsupported hookName: ${s}`);e.addHook(s,O(t)),r()},F=(0,g.default)(Y,{name:"@clerk/fastify",fastify:"5.x"});var D=e=>`\u{1F512} Clerk: ${e.trim()}

For more info, check out the docs: https://clerk.com/docs,
or come say hi in our discord server: https://clerk.com/discord
`,x=D(`The "clerkPlugin" should be registered before using the "getAuth".
Example:

import { clerkPlugin } from '@clerk/fastify';

const server: FastifyInstance = Fastify({ logger: true });
server.register(clerkPlugin);
`);var L=e=>{let t=e;if(!t.auth)throw new Error(x);return t.auth};0&&(module.exports={clerkClient,clerkPlugin,getAuth,...require("@clerk/backend")});
//# sourceMappingURL=index.js.map